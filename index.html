<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Keyboard Hero</title>
    <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src='https://unpkg.com/babel-standalone@6/babel.min.js'></script>
    <link rel="stylesheet" href="style/reset.css">
    <link rel="stylesheet" href="style/style.css">
  </head>
  <body>
    <div id="app"></div>

    <script type='text/babel'>

    function Letters(props) {
      const letters = ['Z', 'Q', 'S', 'D']
      const max = letters.length;

      return (
        <ul className={'bottom_letters'}>
          {letters.map((letter) =>
            <li key={letter}>
              {letter}
            </li>
          )}
        </ul>
      )
    }

    function Grid (props) {
      return (
        <div className={'grid'}>
          <ul className={'col'}>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
          <ul className={'col'}>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
          <ul className={'col'}>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
          <ul className={'col'}>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
        </div>
      )
    }

    class LettersSelection extends React.Component {
      constructor(props) {
        super(props)

        this.state = {
          top: 10
        }
      }

      componentDidMount() {
        const stopper = 600;

        this.interval = setInterval(() => {
          if (this.state.top !== stopper) {
            this.setState({top : this.state.top + 10})
          } else {
            this.props.setNewSelection();
            this.setState({top:10});
          }
        }, 100)
      }

      componentWillUnmount() {
        clearInterval(this.interval);
      }

      render() {
        const {Z,Q,S,D} = this.props.active
        return (
          <div style={{top:`${this.state.top}px`}} className={'LettersSelection'}>
            <SelectedLetter letter='Z' left='0' active={Z}/>
            <SelectedLetter letter='Q' left='80' active={Q}/>
            <SelectedLetter letter='S' left='160' active={S}/>
            <SelectedLetter letter='D' left='240' active={D}/>
          </div>
        )
      }
    }

    function SelectedLetter(props) {
      return (
        <div className={'SelectedLetter'} style={{left: `${props.left}px`, display : props.active ? 'block' : 'none'}}>
          {props.letter}
        </div>
      )
    }

    class App extends React.Component {
      constructor(props) {
        super(props)

        this.state = {
          active : {
            'Z':true,
            'Q':true,
            'S':false,
            'D':true
          }
        }

      this.setNewSelection = this.setNewSelection.bind(this);

      }

      /*shuffle(array) {
        let currentIndex = array.length;
        let temporaryValue;
        let index;

        while (currentIndex > 0) {
            index = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            temporaryValue = array[currentIndex];
            array[currentIndex] = array[index];
            array[index] = temporaryValue;
        }
        return array;
      }*/



      setNewSelection() {
        let booleansArray = [true, true, false, true];
        let currentIndex = booleansArray.length;
        let temporaryValue;
        let index;

        while (currentIndex > 0) {
            index = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            temporaryValue = booleansArray[currentIndex];
            booleansArray[currentIndex] = booleansArray[index];
            booleansArray[index] = temporaryValue;
        }

        this.setState({
          active: {
            'Z': booleansArray[0],
            'Q': booleansArray[1],
            'S': booleansArray[2],
            'D': booleansArray[3]
          }
        })
      }

      render() {
        return (
          <div>
            <LettersSelection active={this.state.active} setNewSelection={this.setNewSelection}/>
            <Grid />
            <Letters />
          </div>
        )
      }
    }

      ReactDOM.render(
      <App />,
      document.getElementById('app')
    )

    </script>
  </body>
</html>
