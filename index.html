<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Keyboard Hero</title>
    <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src='https://unpkg.com/babel-standalone@6/babel.min.js'></script>
    <link rel="stylesheet" href="style/reset.css">
    <link rel="stylesheet" href="style/style.css">
  </head>
  <body>
    <div id="app"></div>

    <script type='text/babel'>

    function Letters(props) {
      const letters = ['Z', 'Q', 'S', 'D']
      const max = letters.length;

      return (
        <ul className={'bottom_letters'}>
          {letters.map((letter) =>
            <li key={letter}>
              {letter}
            </li>
          )}
        </ul>
      )
    }

    function Grid (props) {
      return (
        <div className={'grid'}>
          <ul className={'col'}>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
          <ul className={'col'}>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
          <ul className={'col'}>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
          <ul className={'col'}>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
        </div>
      )
    }

    class LettersSelection extends React.Component {
      constructor(props) {
        super(props)

        this.state = {
          top: 10
        }
      }

      componentDidMount() {
        const stopper = 600;

        this.interval = setInterval(() => {
          if (this.state.top !== stopper) {
            this.setState({top : this.state.top + 10})
          } else {
            this.props.setNewSelection();
            this.setState({top:10});
          }
        }, 50)
      }

      componentWillUnmount() {
        clearInterval(this.interval);
      }

      render() {
        const {Z,Q,S,D} = this.props.active
        return (
          <div style={{top:`${this.state.top}px`}} className={'LettersSelection'}>
            <SelectedLetter letter='Z' left='0' active={Z}/>
            <SelectedLetter letter='Q' left='80' active={Q}/>
            <SelectedLetter letter='S' left='160' active={S}/>
            <SelectedLetter letter='D' left='240' active={D}/>
          </div>
        )
      }
    }

    function SelectedLetter(props) {
      return (
        <div className={'SelectedLetter'} style={{left: `${props.left}px`, display : (props.active === 1) ? 'block' : 'none'}}>
          {props.letter}
        </div>
      )
    }

    class App extends React.Component {
      constructor(props) {
        super(props)

        this.state = {
          active : {
            'Z':1,
            'Q':1,
            'S':0,
            'D':1
          }
        }

      this.setNewSelection = this.setNewSelection.bind(this);

      }

      setNewSelection() {
        const letters = ['Z','Q','S','D']
        let newArray = []

        const getNewArray = () => {
          while (newArray.length !== letters.length) {
            let randomNumber = Math.floor(Math.random() * Math.floor(2));
            newArray.push(randomNumber)
          }
          if (newArray.includes(1) === false) {
            getNewArray()
          }
        }

        getNewArray();

        this.setState({
          active: {
            'Z': newArray[0],
            'Q': newArray[1],
            'S': newArray[2],
            'D': newArray[3]
          }
        })
      }

      render() {
        return (
          <div>
            <LettersSelection active={this.state.active} setNewSelection={this.setNewSelection}/>
            <Grid />
            <Letters />
          </div>
        )
      }
    }

      ReactDOM.render(
      <App />,
      document.getElementById('app')
    )

    </script>
  </body>
</html>
